def remove_active_users():
    logging.info("Removing active users script execution started")

    # Check if servers.txt exists
    if not SERVERS_FILE.exists():
        logging.error(f"servers.txt not found at: {SERVERS_FILE}")
        return

    # Check if file is empty
    if SERVERS_FILE.stat().st_size == 0:
        logging.warning("servers.txt is empty — No active users found. Skipping removal.")
        return

    try:
        result = subprocess.run(
            [
                "powershell",
                "-ExecutionPolicy", "Bypass",
                "-File",
                r"\\awsusdmkfsxn01.jnj.com\mdd_tst_omp\OMP_JNJ_MD_ATOM_LAB\OMPartners\development\dispatcher\bin\Automation\PAK\Remove_Active_Users5.ps1"
            ],
            check=True,
            capture_output=True,
            text=True
        )

        # Log all PowerShell output
        with open(log_filename, "a") as f:
            f.write(result.stdout)
            f.write(result.stderr)

        logging.info("All active users removed successfully.")

    except subprocess.CalledProcessError as e:
        logging.error(f"Active user removal failed with return code {e.returncode}")
        logging.error(f"STDOUT: {e.stdout}")
        logging.error(f"STDERR: {e.stderr}")
        # DO NOT stop script — just log and continue
        logging.warning("Skipping active user removal and continuing execution.")
