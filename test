# Suppress Selenium / Edge noise output
os.environ["WDM_LOG_LEVEL"] = "0"
os.environ["webdriver.edge.silentOutput"] = "true"

# Hide stderr messages
fnull = open(os.devnull, 'w')
sys.stderr = fnull

# Now create Edge options
options = EdgeOptions()
options.add_argument("--inprivate")
options.add_argument("--start-maximized")
options.add_argument("--disable-blink-features=AutomationControlled")
options.add_argument("--log-level=3")
options.add_experimental_option("excludeSwitches", ["enable-logging"])
options.add_experimental_option("useAutomationExtension", False)

prefs = {
    "download.default_directory": str(Path.home() / "Downloads"),
    "download.prompt_for_download": False,
    "download.directory_upgrade": True,
    "safebrowsing.enabled": True,
    "profile.default_content_setting_values.automatic_downloads": 1
}
options.add_experimental_option("prefs", prefs)
